knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
BankData = read.csv("../arrangedData.csv")
dim(BankData)
names(BankData)
summary(BankData)
sapply(BankData, class)
hist(BankData$age,main='Age', xlab='Age', ylab='Frequency')
hist(BankData$job,main='Job', xlab='Job', ylab='Frequency')
hist(BankData$marital,main='Marital', xlab='Marital state', ylab='Frequency')
hist(BankData$education,main='Education', xlab='Education level', ylab='Frequency')
hist(BankData$cons.price.idx,main='Consumer Price Index', xlab='CPI', ylab='Frequency')
#View(BankData)
people_with_housing = BankData[which(BankData$housing == 1),]
people_without_housing = BankData[which(BankData$housing == 0),]
people_with_loan = BankData[which(BankData$loan == 1),]
people_without_loan = BankData[which(BankData$loan == 0),]
young = BankData[which(BankData$age <= 18),]
middle = BankData[which(BankData$age > 18 & BankData$age <= 35),]
old = BankData[which(BankData$age > 35),]
boxplot(people_with_housing$age, people_without_housing$age,
names = c('People with housing loan','People without housing loan'),
main = 'Boxplot of housing loan and age')
cat('Prosječna dob ljudi koji imaju stambeni kredit ', mean(people_with_housing$age), '\n')
cat('Prosječna dob ljudi koji nemaju stambeni kredit ', mean(people_without_housing$age), '\n')
cat('Prosječni postotak mladih ljudi koji imaju stambeni kredit ', mean(young$housing), '\n')
cat('Prosječni postotak srednje starih ljudi koji imaju stambeni kredit ', mean(middle$housing), '\n')
cat('Prosječni postotak starijih ljudi koji imaju stambeni kredit ', mean(old$housing), '\n')
cat('Prosječni postotak mladih ljudi koji imaju privatni kredit ', mean(young$loan), '\n')
cat('Prosječni postotak srednje starih ljudi koji imaju privatni kredit ', mean(middle$loan), '\n')
cat('Prosječni postotak starijih ljudi koji imaju privatni kredit ', mean(old$loan), '\n')
boxplot(people_with_loan$age, people_without_loan$age,
names = c('People with personal loan','People without personal loan'),
main = 'Boxplot of personal loan and age')
cat('Prosječna dob ljudi koji imaju privatni kredit ', mean(people_with_loan$age), '\n')
cat('Prosječna dob ljudi koji nemaju privatni kredit ', mean(people_without_loan$age), '\n')
married_people = BankData[which(BankData$marital == 2),]
divorced_and_single_people = BankData[which(BankData$marital == 1 | BankData$marital == 3),]
#single_people = BankData[which(BankData$marital == 3),]
married_people = BankData[which(BankData$marital == 2),]
divorced_and_single_people = BankData[which(BankData$marital == 1 | BankData$marital == 3),]
#single_people = BankData[which(BankData$marital == 3),]
cat('Prosjek oženjenih ljudi koji imaju privatni kredit ', mean(married_people$loan), '\n')
cat('Prosjek neoženjenih ljudi koji imaju privatni kredit ', mean(divorced_and_single_people$loan), '\n')
hist(married_people$loan,main='Loan for married peope', xlab='0 - no loan, 1- yes loan', ylab='loan')
hist(divorced_and_single_people$loan,main='Loan for divorced or single people', xlab='0 - no loan, 1- yes loan', ylab='loan')
cat('Prosjek oženjenih ljudi koji imaju stambeni kredit ', mean(married_people$housing), '\n')
cat('Prosjek neoženjenih ljudi koji imaju stambeni kredit ', mean(divorced_and_single_people$housing), '\n')
hist(married_people$housing,main='Housing for married people', xlab='0 - no housing, 1- yes housing', ylab='housing')
hist(divorced_and_single_people$housing,main='Housing for divorced or signle people', xlab='0 - no housing, 1- yes housing', ylab='housing')
primary_school = BankData[which(BankData$education == 1 | BankData$education == 2 | BankData$education == 3),]
high_school = BankData[which(BankData$education == 4),]
university = BankData[which(BankData$education == 7),]
illiterate = BankData[which(BankData$education == 5),]
cat('Prosjek ljudi sa završenom samo osnovnom školom koji imaju privatni kredit ', mean(primary_school$loan), '\n')
cat('Prosjek ljudi sa završenom srednjom školom koji imaju privatni kredit ', mean(high_school$loan), '\n')
cat('Prosjek ljudi sa završenim fakulteteom koji imaju privatni kredit ', mean(university$loan), '\n')
cat('Prosjek nepismenih ljudi koji imaju privatni kredit ', mean(illiterate$loan), '\n')
hist(primary_school$loan,main='Loan for primary school', xlab='0 - no loan, 1- yes loan', ylab='loan')
hist(high_school$loan,main='Loan for high school', xlab='0 - no loan, 1- yes loan', ylab='loan')
hist(university$loan,main='Loan for university', xlab='0 - no loan, 1- yes loan', ylab='loan')
hist(illiterate$loan,main='Loan for illiterate people', xlab='0 - no loan, 1- yes loan', ylab='loan')
cat('Prosjek ljudi sa završenom samo osnovnom školom koji imaju stambeni kredit ', mean(primary_school$housing), '\n')
cat('Prosjek ljudi sa završenom srednjom školom koji imaju stambeni kredit ', mean(high_school$housing), '\n')
cat('Prosjek ljudi sa završenim fakulteteom koji imaju stambeni kredit ', mean(university$housing), '\n')
cat('Prosjek nepismenih ljudi koji imaju stambeni kredit ', mean(illiterate$housing), '\n')
hist(primary_school$housing,main='Housing for primary school', xlab='0 - no housing, 1- yes housing', ylab='housing')
hist(high_school$housing,main='Housing for high school', xlab='0 - no housing, 1- yes housing', ylab='housing')
hist(university$housing,main='Housing for university', xlab='0 - no housing, 1- yes housing', ylab='housing')
hist(illiterate$housing,main='Housing for illiterate people', xlab='0 - no housing, 1- yes housing', ylab='housing')
hist(BankData$cons.price.idx,main='CPI', xlab='CPI', ylab='Frequency')
cat('Prosječni CPI mladih ljudi ', mean(young$cons.price.idx), '\n')
cat('Prosječni CPI srednje starih ljudi', mean(middle$cons.price.idx), '\n')
cat('Prosječni CPI starijih ljudi ', mean(old$cons.price.idx), '\n')
cat('Prosječni CPI za sve ispitanike', mean(BankData$cons.price.idx))
boxplot(young$cons.price.idx, middle$cons.price.idx,old$cons.price.idx,
names = c('CPI of young','CPI od middle aged', 'CPI of older'),
main = 'Boxplot of CPI and age')
hist(BankData$cons.price.idx)
boxplot(BankData$cons.price.idx~BankData$education)
cat('Prosječni CPI ljudi sa završenom samo osnovnom školom ', mean(primary_school$cons.price.idx), '\n')
cat('Prosječni CPI ljudi sa završenom srednjom školom', mean(high_school$cons.price.idx), '\n')
cat('Prosječni CPI ljudi sa završenim fakultetom ', mean(university$cons.price.idx), '\n')
cat('Prosječni CPI nepismenih ljudi', mean(illiterate$cons.price.idx))
boxplot(primary_school$cons.price.idx, high_school$cons.price.idx,university$cons.price.idx, illiterate$cons.price.idx,
names = c('CPI of primary school','CPI od high school', 'CPI of university people', 'CPI of illiterate people'),
main = 'Boxplot of CPI and education')
boxplot(young$cons.price.idx, middle$cons.price.idx,old$cons.price.idx,
names = c('CPI of young','CPI od middle aged', 'CPI of older'),
main = 'Boxplot of CPI and age')
boxplot(BankData$cons.price.idx~BankData$marital,
main = 'Boxplot of CPI and marital status')
cat('Prosječni CPI za ljude koji imaju stambeni kredit ', mean(people_with_housing$cons.price.idx), '\n')
cat('Prosječni CPI za ljude koji neamaju stambeni kredit ', mean(people_without_housing$cons.price.idx), '\n')
hist(people_with_housing$cons.price.idx,main='CPI for people with housing loan', xlab='CPI', ylab='količina')
hist(people_without_housing$cons.price.idx,main='CPI for people without housing loan', xlab='CPI', ylab='količina')
boxplot(BankData$cons.price.idx~BankData$housing,
main = 'Boxplot of CPI and housing loan')
cat('Prosječni CPI za ljude koji imaju privatni kredit ', mean(people_with_loan$cons.price.idx), '\n')
cat('Prosječni CPI za ljude koji nemaaju privatni kredit ', mean(people_without_loan$cons.price.idx), '\n')
hist(people_with_loan$cons.price.idx,main='CPI for people with private loan', xlab='CPI', ylab='količina')
hist(people_without_loan$cons.price.idx,main='CPI for people without private loan', xlab='CPI', ylab='količina')
boxplot(BankData$cons.price.idx~BankData$loan,
main = 'Boxplot of CPI and private loan')
View(BankData)
cat('Prosječni CFI za ljude koji imaju privatni kredit ', mean(people_with_loan$cons.conf.idx), '\n')
cat('Prosječni CFI za ljude koji nemaaju privatni kredit ', mean(people_without_loan$cons.conf.idx), '\n')
cat('Prosječni CCI za ljude koji imaju privatni kredit ', mean(people_with_loan$cons.conf.idx), '\n')
cat('Prosječni CCI za ljude koji nemaaju privatni kredit ', mean(people_without_loan$cons.conf.idx), '\n')
boxplot(BankData$cons.conf.idx~BankData$housing,
main = 'Boxplot of CCI and hosuing loan')
boxplot(BankData$cons.conf.idx~BankData$housing,
main = 'Boxplot of CCI and hosuing loan')
library(tidyverse)
theme_set(theme_bw())
theme_set(theme_bw())
model <- glm( subscribed ~., data = BankData, family = binomial)
theme_set(theme_bw())
model <- glm( subscribed ~., data = BankData, family = binomial)
summary(model)
set.seed(123)
training.samples <- BankData$subscribed %>%
createDataPartition(p = 0.8)
set.seed(123)
training.samples <- BankData %>%
createDataPartition(p = 0.8)
model <- glm(cons.price.idx ~ housing, data = BankData, family = binomial)
subscribed = BankData[which(BankData$subscribed == 1),]
not_subscribed = BankData[which(BankData$subscribed == 0),]
cat('Prosječni CPI za ljude koji su se prijavili ', mean(subscribed$cons.price.idx), '\n')
cat('Prosječni CPI za ljude koji se nisu prijavili ', mean(not_subscribed$cons.price.idx), '\n')
boxplot(BankData$subscribed~BankData$cons.price.idx,
main = 'Boxplot of CPI and subscribing')
boxplot(BankData$cons.price.idx~BankData$subscribed,
main = 'Boxplot of CPI and subscribing')
cat('Prosječni CCI za ljude koji su se prijavili ', mean(subscribed$cons.conf.idx), '\n')
cat('Prosječni CCI za ljude koji se nisu prijavili ', mean(not_subscribed$cons.conf.idx), '\n')
boxplot(BankData$cons.conf.idx~BankData$subscribed,
main = 'Boxplot of CCI and subscribing')
cat('Prosjek pretplaćenih mladih ljudi ', mean(young$subscribed), '\n')
cat('Prosjek pretplaćenih srednje starih ljudi ', mean(middle$subscribed), '\n')
cat('Prosjek pretplaćenih starijih ljudi ', mean(middle$subscribed), '\n')
cat('Prosječno pretplaćenih ljudi sa završenom osnovnom školom ', mean(primary_school$subscribed), '\n')
cat('Prosječno pretplaćenih ljudi sa završenom srednjom školom ', mean(high_school$subscribed), '\n')
cat('Prosječno pretplaćenih ljudi sa završenim fakultetom ', mean(university$subscribed), '\n')
cat('Prosječno pretplaćenih nepismenih ljudi ', mean(illiterate$subscribed), '\n')
cat('Prosjek preplaćenih ljudi koji su oženjeni ', mean(married_people$subscribed), '\n')
cat('Prosjek preplaćenih ljudi koji su neoženjeni ili rastavljeni ', mean(divorced_and_single_people$subscribed), '\n')
scatter.smooth(BankData$marital, BankData$subscribed)
plot(BankData$marital, BankData$subscribed, main="Scatterplot",)
x <- c(21, 62, 10, 53)
labels <- c("London", "New York", "Singapore", "Mumbai")
pie(x, labels, radius, main = "Pie chart of marital and subscription")
x <- c(21, 62, 10, 53)
labels <- c("London", "New York", "Singapore", "Mumbai")
pie(x, labels, main = "Pie chart of marital and subscription")
cat('Prosjek preplaćenih ljudi koji su oženjeni ', mean(married_people$subscribed), '\n')
cat('Prosjek preplaćenih ljudi koji su neoženjeni ili rastavljeni ', mean(divorced_and_single_people$subscribed), '\n')
x <- c(12.43, 87.57, 14.95, 85.05)
labels <- c("Married and subscribed", "Married and not subscribed", "Not married and subscribed", "Not married and not subscribed")
pie(x, labels, main = "Pie chart of marital and subscription")
x <- c(11, 123, 16, 195)
labels <- c("Primary school finshed and subscribed", "High school finished and not subscribed", "Uni finished and subscribed", "Illiterate not subscribed")
pie(x, labels, main = "Pie chart of marital and subscription")
x <- c(11, 13, 16, 19)
labels <- c("Primary school finshed and subscribed", "High school finished and not subscribed", "Uni finished and subscribed", "Illiterate and not subscribed")
pie(x, labels, main = "Pie chart of marital and subscription")
x <- c(11, 13, 16, 19)
labels <- c("Primary school finshed", "High school finished", "Uni finished", "Illiterate")
pie(x, labels, main = "Pie chart of subscribed people")
x <- c(42, 14, 14)
labels <- c("younger", "middle aged", "older")
pie(x, labels, main = "Pie chart of subscribed people")
x <- c(12.43, 14.95)
labels <- c("Married", "Not married")
pie(x, labels, main = "Pie chart of subscribed people")
