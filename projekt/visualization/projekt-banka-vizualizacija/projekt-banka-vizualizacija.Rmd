---
title: "Vizualizacija marketinških podataka portugalske banke"
author: "Tina, Josip and Mateo"
date: "1/8/2022"
output:
  pdf_document: default
  html_document: default
---

__OPIS PROJEKTA__

U ovom projektu radimo analizu podataka dobivenih anketiranjem od strane jedne portugalske banke. Ispitanici su dali svoje osobne podatke poput godina, države, spola, posla, razine obrazovanja.., te podatke o kreditima, tj. imaju li stambeni i privatni kredit.

Cilj projekta je analizirati dani skup podataka, očistiti ga i pronaći regresore koje stvaraju dovoljno dobar model za naše kategorične podatke. 
Kategorični podatci koje imamo jesu: loan, housing i subscribed. Subscribed je varijabla od najvećeg značaja banci. 

Subscribed je krajnji cilj jer loan i housing utječu na isti. Ukoliko pronađemo povezanost za navedene prve dvije varijable, moći ćemo točno znati kome usmjeriti naše marketing pozive i 
moći ćemo predvidjeti hoće li osoba na temelju danih podataka se ostaviti depozit u našoj banci ili neće.

U ovom dijelu radit ćemo vizualizaciju podataka, da vidimo čime raspolažemo i kako su ti podaci međusobno povezani. Prikazivat ćemo uglavnom grafovima zavisnost.

__Opis skupa podataka__

Za početak ćemo opisati ćime raspolažemo.

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE) 
```

#ucitavanje paketa
Učitajmo potrebne pakete

```{r echo=T, error=FALSE, warning=FALSE, message=FALSE}
library(dplyr)

```

#Učitavanje podataka

Učitajmo podatke iz .csv file-a
```{r}
BankData = read.csv("../arrangedData.csv")
dim(BankData)
```
Podaci se sastoje od 30 372 testiranih ljudi i 15 varijabli koje promatramo.

Popis varijabli koje promatramo:
```{r}
names(BankData)
```
Za testirane sudionike u tablici su navedeni njihovi podaci (godina, posao, stanje ženidbe, edukacija...) te podaci o kreditima...(stambeni i privatni)


Promotrimo sada kako izgledaju varijable koje dobijemo kao informaciju od ispitanika (godine, posao, ženidbeno stanje)
Gledat ćemo histograme da možemo vidjeti jesu li podaci barem približno normalni, te boxplot da vidimo prosjek i outliere.

AGE
```{r}
hist(BankData$age,main='Age', xlab='Age', ylab='Frequency')

```

```{r}
boxplot(BankData$age)
```
Vidimo da je prosjek malo ispod 40 godina te da ima nekoliko outliera, iako se većina kreće od 20 do 50 godina.



POSAO
- admin:1
- bluecollar:2
- entrepreneur:3
- housemaid:4
- management:5
- retired:6
- self-employed:7
- services:8
- student:9
- technician:10
- unemployed:11

```{r}
hist(BankData$job,main='Job', xlab='Job', ylab='Frequency')

```
Po ovom histogramu vidimo da je najviše zaposlenih u administraciji, a nakon toga u tehnologiji i fizičkim poslovima. Najmanje ispitanika su studenti i samozaposleni.



ŽENIDBENO STANJE
- 1 = rastavljen / a
- 2 = oženjen / udana
- 3 = slobodan / slobodna
```{r}
hist(BankData$marital,main='Marital', xlab='Marital state', ylab='Frequency', binwidth=12)

```
Vidimo da je najviše oženjenih, a najmanje rastavljenih među ispitinima.



EDUKACIJA

- basic.4y: 1
- basic.6y: 2
- basic.9y: 3
- high.school: 4
- illiterate: 5
- professional.course: 6
- university.degree: 7

```{r}
hist(BankData$education,main='Education', xlab='Education level', ylab='Frequency')

```
Na danom histogramu vidimo da je najviše ispitanika završilo fakultet, a nakon toga barem srednju školu. Najmanje ih je nepismenih ili samo s osnovnom školom
.
Sada smo samo prikazali grafički neke osnovne podatke koje dobijemo za svakog ispitanika. 


Sljedeće ćemo pokazati odnose svakih od tih svojstava s varijablama vezane za kredite (housing, loan, default) kao što smo rekli na početku.



DOB i KREDITI:

Podijelit ćemo dataset na mlađe, srednje mlade, te starije osobe i promatrati njihove kredite.
Za mlađe smo uzeli osobe s 18 i manje godina, za srednje mlade one s 19 do 35, a za starije više od 35 godina starosti.

```{r}
#View(BankData)

people_with_housing = BankData[which(BankData$housing == 1),]
people_without_housing = BankData[which(BankData$housing == 0),]
people_with_loan = BankData[which(BankData$loan == 1),]
people_without_loan = BankData[which(BankData$loan == 0),]
people_with_credit = BankData[which(BankData$default == 1),]
people_without_credit = BankData[which(BankData$default == 0),]
```
Također ćemo podatke podijeliti i po tome ima li osoba kredit ili ne.
```{r}
young = BankData[which(BankData$age <= 25),]
middle = BankData[which(BankData$age > 25 & BankData$age <= 45),]
old = BankData[which(BankData$age > 45),]
```

Prosjeci po godinama za stambeni kredit:

```{r}
cat('Prosječni postotak mladih ljudi koji imaju stambeni kredit ', mean(young$housing) * 100, '\n')
cat('Prosječni postotak srednje starih ljudi koji imaju stambeni kredit ', mean(middle$housing) * 100, '\n')
cat('Prosječni postotak starijih ljudi koji imaju stambeni kredit ', mean(old$housing) * 100, '\n')
```
Vidimo da najviše stambenog kredita imaju mladi ljudi, ali razlike nisu velike.


Boxplot starosti ljudi koji imaju stambeni kredit:
```{r}
boxplot(people_with_housing$age, people_without_housing$age,
        names = c('People with housing loan','People without housing loan'),
        main = 'Boxplot of housing loan and age')
```



Prosjeci po godinama za privatni kredit:
```{r}
cat('Prosječni postotak mladih ljudi koji imaju privatni kredit ', mean(young$loan) * 100, '\n')
cat('Prosječni postotak srednje starih ljudi koji imaju privatni kredit ', mean(middle$loan) * 100, '\n')
cat('Prosječni postotak starijih ljudi koji imaju privatni kredit ', mean(old$loan) * 100, '\n')
```


Za privatni kredit također možemo vidjeti da najviše imaju mlađi ljudi, ali nisu neke bitne razlike.


Boxplot starosti ljudi koji imaju privatni kredit
```{r}
boxplot(people_with_loan$age, people_without_loan$age,
        names = c('People with personal loan','People without personal loan'),
        main = 'Boxplot of personal loan and age')
```



MARITAL STATUS


Podjela ispitanika ovisno o statusu ženidbe:
```{r}
married_people = BankData[which(BankData$marital == 2),]
divorced_and_single_people = BankData[which(BankData$marital == 1 | BankData$marital == 3),]
#single_people = BankData[which(BankData$marital == 3),]
```
Prosjeci ljudi koji imaju privatni kredit:
```{r}
cat('Prosjek oženjenih ljudi koji imaju privatni kredit ', mean(married_people$loan) * 100, '\n')
cat('Prosjek neoženjenih ljudi koji imaju privatni kredit ', mean(divorced_and_single_people$loan) * 100, '\n')
```


Pie chart za ženidbeni status i privatni kredit:
```{r}
x <- c(15.66, 84.44)
labels <- c("has private loan", "has not private loan")

pie(x, labels, main = "Pie chart of married people")
```



Prosjeci ljudi koji imaju stambeni kredit:
```{r}
cat('Prosjek oženjenih ljudi koji imaju stambeni kredit ', mean(married_people$housing) * 100, '\n')
cat('Prosjek neoženjenih ljudi koji imaju stambeni kredit ', mean(divorced_and_single_people$housing) * 100, '\n')
```

Pie chart za ženidbeni status i stambeni kredit:

```{r}
x <- c(53.64, 46.36)
labels <- c("has housing loan", "has not housing loan")

pie(x, labels, main = "Pie chart of married people")
```



EDUKACIJA

Podjela ispitanika u ovisnosti o završenom statusu edukacije:
```{r}
primary_school = BankData[which(BankData$education == 1 | BankData$education == 2 | BankData$education == 3),]
high_school = BankData[which(BankData$education == 4),]
university = BankData[which(BankData$education == 7),]
illiterate = BankData[which(BankData$education == 5),]
```

Pirvatni kredit u ovisnosti o edukaciji:
```{r}
cat('Prosjek ljudi sa završenom samo osnovnom školom koji imaju privatni kredit ', mean(primary_school$loan) * 100, '\n')
cat('Prosjek ljudi sa završenom srednjom školom koji imaju privatni kredit ', mean(high_school$loan) * 100, '\n')
cat('Prosjek ljudi sa završenim fakulteteom koji imaju privatni kredit ', mean(university$loan) * 100, '\n')
cat('Prosjek nepismenih ljudi koji imaju privatni kredit ', mean(illiterate$loan) * 100, '\n')
```

Vidimo da najveći privatni kredit imaju najobrazovaniji, tj sa završenim fakultetom, a najmanje nepismeni (uzmimo u obzir da je najmanji broj ispitanika nepismeno).



Pie chart prikaz:
```{r}
mean = mean(15.15073, 15.51371 , 16.13934, 14.7007 )

x <- c(15.15073/mean, 15.51371/mean, 16.13934/mean, 14.7007/mean)
labels <- c("primary school", "high school", "university", "illiterate")

pie(x, labels, main = "Pie chart of of people having private loan")


```



Stambeni kredit u ovisnosti o edukaciji:
```{r}
cat('Prosjek ljudi sa završenom samo osnovnom školom koji imaju stambeni kredit ', mean(primary_school$housing) * 100, '\n')
cat('Prosjek ljudi sa završenom srednjom školom koji imaju stambeni kredit ', mean(high_school$housing)* 100, '\n')
cat('Prosjek ljudi sa završenim fakulteteom koji imaju stambeni kredit ', mean(university$housing)* 100, '\n')
cat('Prosjek nepismenih ljudi koji imaju stambeni kredit ', mean(illiterate$housing)* 100, '\n')
```
Iz ispisivanja srednjih vrijednosti možemo vidjeti da je stambeni kredit najmanje uzimalo nepismenih ljudi (kojih je inače jako malo u našem skupu podataka), a najviše je u stambenom kreditu ljudi s završenim fakultetom. Kad razmislimo to ima smisla jer ljudi s fakuletetom vjerojatno imaju, prema prosjecima, najveće sigurne plaće i isplaniraju isplatu tog kredita jer je njihov posao siguran.



Pie chart:
```{r}
mean = mean(53.24659, 52.84486 , 54.83581, 52.02465 )

x <- c(53.24659/mean, 52.84486/mean, 54.83581/mean, 52.02465/mean)
labels <- c("primary school", "high school", "university", "illiterate")

pie(x, labels, main = "Pie chart of of people having housing loan")


```



Na grafu vidimo da te razlike nisu velike.. vidljive su ali ne toliko..


Sada smo provjerili zavisnost većine varijabli (edukacija, dob, ženidbeni status) o kreditima (housing i loan). Nakon toga pogledat ćemo ovisnost tih varijabli o glavnoj koju promatramo, a to je output varijabla subscribed, tj varijabla koja nam govori je li se ispitanik na kraju pretplatio, tj. hoće li u buduće ostavljati novce u banci..

Gledat ćemo ovisnost do sada promatranih varijabli o tome je li se ispitanik *pretplatio*.


Za početak ćemo podijeliti dataset na one koji su se prijavili i one koji nisu:
```{r}
subscribed = BankData[which(BankData$subscribed == 1),]
not_subscribed = BankData[which(BankData$subscribed == 0),]
```



GODINE i PRETPLAĆIVANJE


Gledamo prosjeke pretplaćenih ovisno o godinama:

```{r}
cat('Prosjek pretplaćenih mladih ljudi ', mean(young$subscribed) * 100, '\n')
cat('Prosjek pretplaćenih srednje starih ljudi ', mean(middle$subscribed) * 100, '\n')
cat('Prosjek pretplaćenih starijih ljudi ', mean(old$subscribed) * 100, '\n')
```

Vidimo da pretplaćivanje ovisi o dobi.. tj. da najviše mladih ljudi "postane dio banke". To ima smisla jer vjerojatno velik broj starijih ljudi već ima račune u nekoj drugoj banci..


Pie chart za pretplaćene ovisno o godinama:
```{r}
mean = mean(23.22946, 11.93425, 16.03468)

x <- c(23.22946/mean, 11.93425/mean, 16.03468/mean)

labels <- c("younger", "middle aged", "older")

pie(x, labels, main = "Pie chart of subscribed people")
```

Ovdje je također očito da je najviše pretplaćeno mladih ljudi.




EDUKACIJA i PRETPLAĆIVANJE

Gledamo prosjeke pretplaćenih ovisno o edukaciji:

```{r}
cat('Prosječno pretplaćenih ljudi sa završenom osnovnom školom ', mean(primary_school$subscribed) * 100, '\n')
cat('Prosječno pretplaćenih ljudi sa završenom srednjom školom ', mean(high_school$subscribed) * 100, '\n')
cat('Prosječno pretplaćenih ljudi sa završenim fakultetom ', mean(university$subscribed) * 100, '\n')
cat('Prosječno pretplaćenih nepismenih ljudi ', mean(illiterate$subscribed) * 100, '\n')
```

Vidimo da je pretplaćeno najviše nepismenih ljudi (uzmimo u obzir da je njih za razliku od ostalih jako malo testirano), a najmanje onih koji su završili samo osnovnu školu.

Pie chart za edukaciju i pretplaćenost:
```{r}

mean = mean(10.95079, 12.77118, 15.55045, 19.19014)
x <- c(10.95079/mean, 12.77118/mean, 15.55045/mean, 19.19014/mean)

labels <- c("Primary school finsihed", "High school finished", "Uni finished", "Illiterate")

pie(x, labels, main = "Pie chart of subscribed people")
```

Pie chart samo opisuje ovo napisno gore.




ŽENIDBENI STATUS i PRETPLAĆIVANJE


Sada gledamo prosjek pretplaćenih ovisno o bračnom statusu:

```{r}
cat('Prosjek preplaćenih ljudi koji su oženjeni ', mean(married_people$subscribed) * 100, '\n')
cat('Prosjek preplaćenih ljudi koji su neoženjeni ili rastavljeni ', mean(divorced_and_single_people$subscribed) * 100, '\n')
```

Vidimo da je više pretplaćeno ljudi koji su neoženjeni ili rastavljeni.



Pie chart ženidbenog statusa i pretplaćivanja:
```{r}
x <- c(12.43, 14.95)
labels <- c("Married", "Not married")

pie(x, labels, main = "Pie chart of subscribed people")
```



Sada smo napravili i analizu pretplaćenih i nepretplaćenih ljudi ovisno o godinama, edukaciji i ženidbenom statusu i vidjeli neke potencijalne zaključke, ali to ćemo detaljnije vidjeti u kodu.
Vizualizacija služi samo za bolje razumijevanje podataka i njihovog prikaza.









